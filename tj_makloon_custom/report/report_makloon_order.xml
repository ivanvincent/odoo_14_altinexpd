<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- academic = folder name addons-->
        <report
            menu="False"
            id="report_makloon_order_report"
            string="Makloon Order Textile"
            model="makloon.order"
            report_type="qweb-pdf"
            file="tj_makloon_custom.report_makloon_order"
            name="tj_makloon_custom.makloon_order_report"/>

          <template id="makloon_order_report">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="tj_makloon_custom.makloon_order_report_document"/>
                </t>
            </t>
        </template>

        <template id="makloon_order_report_document">

            <tr t-call="report.external_layout">
                <div class="page">
                    <div class="oe_structure"/>
                    <h3>
                        <center>
                            <span t-if="o.stage_id.operation_name == 'RAJUT'">Makloon Order Rajut</span>
                            <span t-if="o.stage_id.operation_name == 'CELUP'">Makloon Order Celup</span>
                            <span t-if="o.stage_id.operation_name == 'PRINTING'">Makloon Order Printing</span>
                        </center>
                    </h3>
                    <div class="oe_structure"/>
                        <div class="col-xs-4 pull-right">
                            <div>
                                <span><strong>Makloon Ke,</strong></span>
                            </div>
                            <div name="partner_header">
                                <div t-field="o.partner_id"
                                   t-options='{"widget": "contact", "fields": ["address", "name", "phone", "fax"], "no_marker": True, "phone_icons": True}'/>
                            </div><br/>
                        </div>

                    <table>
                        <tr><td>Date Order: </td> <td><span t-field="o.date_order"/></td></tr>
                        <tr><td>No Order: </td> <td><span t-field="o.name"/></td></tr>
                        <tr><td>Referensi: </td> <td><span t-field="o.origin"/></td></tr>
                    </table>

                    <h3 t-if="o.stage_id.operation_name == 'RAJUT'">Bahan Makloon Rajut</h3>
                    <h3 t-if="o.stage_id.operation_name == 'CELUP'">Bahan Makloon Celup</h3>
                    <h3 t-if="o.stage_id.operation_name == 'PRINTING'">Bahan Makloon Printing</h3>

                    <table class="table table-condensed">
                        <thead  height="30">
                            <tr>
                                <th>Nama Bahan</th>
                                <th>No Purchase</th>
                                <th>No Surat Jalan</th>
                                <th>Jumlah</th>
                                <th>Satuan</th>
                                <th>Kg</th>
                            </tr>
                       </thead>

                       <tbody>
                            <tr t-foreach="o.material_ids" t-as="l">
                                <td>
                                   <span t-field="l.product_id"/>
                                </td>
                                <td>
                                   <span t-field="l.no_po"/>
                                </td>
                                <td>
                                   <span t-field="l.no_sj"/>
                                </td>
                                <td>
                                    <span t-field="l.product_uom_qty" />
                                </td>
                                <td>
                                    <span t-field="l.product_uom" />
                                </td>
                                <td>
                                    <span t-field="l.product_kg" />
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 t-if="o.stage_id.operation_name == 'RAJUT'">Hasil Makloon Rajut</h3>
                    <h3 t-if="o.stage_id.operation_name == 'CELUP'">Hasil Makloon Celup</h3>
                    <h3 t-if="o.stage_id.operation_name == 'PRINTING'">Hasil Makloon Printing</h3>

                    <table class="table table-condensed">
                        <thead  height="30">
                            <tr>
                                <th>Nama Bahan</th>
                                <th>Setting Jadi</th>
                                <th>Gramasi Matang</th>
                                <th>Corak</th>
                                <th t-if="o.stage_id.operation_name == 'CELUP'">Resep Warna</th>
                                <th t-if="o.stage_id.operation_name == 'CELUP'">Warna</th>
                                <th t-if="o.stage_id.operation_name == 'CELUP'">Category Warna</th>
                                <th>Jumlah</th>
                                <th>Satuan</th>
                                <th>Service Product</th>
                                <th>Waste/Valasi in %</th>
                                <th>Harga@</th>
                                <th>Subtotal</th>
                            </tr>
                       </thead>

                       <tbody>
                           <t t-set="sum_amount" t-value="0"/>
                            <tr t-foreach="o.result_ids" t-as="l">
                                <td>
                                   <span t-field="l.product_id"/>
                                </td>
                                <td>
                                   <span t-field="l.product_setting_id"/>
                                </td>
                                <td>
                                   <span t-field="l.product_gramasi_id"/>
                                </td>
                                <td>
                                   <span t-field="l.product_corak_id"/>
                                </td>
                                <td t-if="o.stage_id.operation_name == 'CELUP'">
                                   <span t-field="l.product_resep_warna_id"/>
                                </td>
                                <td t-if="o.stage_id.operation_name == 'CELUP'">
                                   <span t-field="l.product_warna_id"/>
                                </td>
                                <td t-if="o.stage_id.operation_name == 'CELUP'">
                                   <span t-field="l.product_category_warna_id"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="l.product_uom_qty" />
                                </td>
                                <td>
                                    <span t-field="l.product_uom" />
                                </td>
                                <td>
                                    <span t-field="l.service_product_id" />
                                </td>
                                <td class="text-right">
                                    <span t-field="l.waste_valasi" />
                                </td>
                                <td class="text-right">
                                    <span t-field="l.price_unit" />
                                </td>
                                <td class="text-right">
                                    <span t-field="l.price_subtotal" />
                                    <t t-set="sum_amount" t-value="sum_amount+l.price_subtotal"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            <div class="row">
                <div class="col-xs-4 pull-right">
                    <table class="table table-condensed">
                        <!--<tr class="border-black">-->
                            <!--<td><strong>Total Without Taxes</strong></td>-->
                            <!--<td class="text-right">-->
                                <!--<span t-field="o.amount_untaxed"-->
                                    <!--t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>-->
                            <!--</td>-->
                        <!--</tr>-->
                        <!--<tr>-->
                            <!--<td>Taxes</td>-->
                            <!--<td class="text-right">-->
                                <!--<span t-field="o.amount_tax"-->
                                    <!--t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>-->
                            <!--</td>-->
                        <!--</tr>-->
                        <tr class="border-black">
                            <td><strong>Total</strong></td>
                            <td class="text-right">
                                <!--<span t-field="o.amount_total"-->
                                    <!--t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>-->
                                <t t-esc="sum_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <p>
                Catatan
            </p>
            <p t-field="o.notes"/>

                    <table class="table">
                        <tr>
                            <td>Disetujui,</td>

                            <td>Dibuat,</td>
                        </tr>
                        <tr style="padding-top:200px">
                            <td>(ERIC SUTANTO)</td>

                            <td>.................</td>
                        </tr>
                    </table>
                    <div class="oe_structure"/>
                </div>
            </tr>
        </template>
    </data>
</odoo>
