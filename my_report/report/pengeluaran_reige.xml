<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record model="report.paperformat" id="paperformat_pengeluaran_greige_a4">
            <field name="name">Pengeluaran Greige A4</field>
            <field name="default" eval="True" />
            <field name="format">custom</field>
            <field name="page_width">210</field>
            <field name="page_height">297</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">0</field>
            <field name="margin_bottom">0</field>
            <field name="margin_right">0</field>
            <field name="margin_left">0</field>
            <field name="header_line" eval="False" />
            <field name="header_spacing">35</field>
            <field name="dpi">90</field>
        </record>

        <report id="action_pengeluaran_greige_a4" model="stock.picking" string="Print Pengeluaran Greige A4" report_type="qweb-pdf" name="my_report.pengeluaran_greige_a4" file="my_report.pengeluaran_greige_a4" />

        <record id="action_pengeluaran_greige_a4" model="ir.actions.report">
            <field name="paperformat_id" eval="paperformat_pengeluaran_greige_a4" />
        </record>

        <template id="pengeluaran_greige_a4">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <div class="article">
                        <table class="table-condensed" width="100%">
                            <tr>
                                <!--START TABLE KIRI-->
                                <td width="40%">
                                    <div class="text-right">OO-03 REV 02</div>
                                    <div class="text-left" style="margin-top : -20px">
                                        <b>FORM PENGELUARAN GREIGE</b>
                                    </div>
                                    <table class="table-condensed" width="100%">
                                        <t t-set="jenis_kain" t-value="0"/>
                                        <t t-set="kode_design" t-value="0"/>
                                        <t t-set="uom" t-value="0"/>
                                        <t t-set="lebar" t-value="0"/>
                                        <t t-set="gramasi" t-value="0"/>
                                        <t t-set="pic" t-value="0"/>
                                        <t t-set="yard" t-value="0"/>
                                        <t t-set="berat" t-value="0"/>
                                        <t t-set="speed" t-value="0"/>
                                        <t t-foreach="o.move_ids_without_package" t-as="line">
                                            <t t-set="jenis_kain" t-value="line.product_id.name"/>
                                            <t t-set="kode_design" t-value="line.product_id.default_code"/>
                                            <t t-set="uom" t-value="line.product_uom.name"/>
                                            <t t-set="lebar" t-value="line.product_id.lebar"/>
                                            <t t-set="gramasi" t-value="line.product_id.gramasi_greige"/>
                                            <t t-set="pic" t-value="line.product_id.pic"/>
                                            <t t-set="speed" t-value="line.product_id.speed"/>
                                            <t t-set="yard" t-value="yard + line.quantity_done"/>
                                            <t t-set="berat" t-value="yard * gramasi * 0.9144 / 1000"/>
                                        </t>
                                        <tr>
                                            <td width="40%">
                                                <span>HARI/TANGGAL</span>
                                                <br/>
                                                <span>NO KELUAR</span>
                                                <br/>
                                                <span>JENIS KAIN</span>
                                                <br/>
                                                <span>KODE DESIGN</span>
                                                <br/>
                                                <span>UNIT</span>
                                                <br/>
                                            </td>
                                            <td colspan="3">
                                                <span>:</span>
                                                <span t-field="o.scheduled_date"/>
                                                <br/>
                                                <span>:</span>
                                                <span t-field="o.name"/>
                                                <br/>
                                                <span>:</span>
                                                <span t-esc="jenis_kain"/>
                                                <br/>
                                                <span>:</span>
                                                <span t-esc="kode_design"/>
                                                <br/>
                                                <span>:</span>
                                                <span t-esc="uom"/>
                                                <br/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td width="40%">
                                                <span>Lebar Grey</span>
                                                <br/>
                                                <span>Pick Grey</span>
                                                <br/>
                                            </td>
                                            <td width="20%">
                                                <span>:</span>
                                                <span t-field="o.production_id.td_id.lebar_target"/>
                                                <br/>
                                                <span>:</span>
                                                <span t-field="o.production_id.td_id.density"/>
                                                <br/>
                                            </td>
                                            <td width="20%">
                                                <span>Gramasi</span>
                                                <br/>
                                                <span>Speed</span>
                                                <br/>
                                            </td>
                                            <td width="20%">
                                                <span>:</span>
                                                <span t-field="o.production_id.td_id.gramasi_target"/>
                                                <br/>
                                                <span>:</span>
                                                <span t-esc="speed"/>
                                                <br/>
                                            </td>
                                        </tr>
                                    </table>
                                    <table class="table-condensed" width="100%">
                                        <thead>
                                            <tr style="padding-left : 10px ; padding-right : 10px" class="text-center">
                                                <td style="border : 1px solid black">No</td>
                                                <td style="border : 1px solid black">Kode Kain</td>
                                                <td style="border : 1px solid black">Barcode</td>
                                                <td style="border : 1px solid black">Yard</td>
                                                <td style="border : 1px solid black">GD</td>
                                                <td style="border : 1px solid black">KET</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-set="roll" t-value="0"/>
                                            <t t-set="grand_total" t-value="0"/>
                                            <t t-set="move" t-value="o.group_by_nozle_grade()"/>
                                            <t t-foreach="move" t-as="m">
                                                <tr>
                                                    <td colspan="2">
                                                        <strong><span t-esc="m" /></strong>
                                                    </td>   
                                                </tr>
                                                <t t-set="no" t-value="0"/>
                                                <t t-set="tot_qty" t-value="0"/>
                                                <t t-foreach="o.move_line_ids_without_package" t-as="l">
                                                    <t t-if="m == o.get_selection_label('stock.move.line', 'nozle', l.nozle)">
                                                        <t t-set="roll" t-value="roll + 1"/>
                                                        <t t-set="grand_total" t-value="grand_total + l.qty_done"/>
                                                        <t t-set="no" t-value="no + 1"/>
                                                        <t t-set="tot_qty" t-value="tot_qty + l.qty_done"/>
                                                        <tr style="padding-left : 10px ; padding-right : 10px" class="text-center">
                                                            <td style="border : 1px solid black">
                                                                <span t-esc="no"/>
                                                            </td>
                                                            <td style="border : 1px solid black">
                                                                <span t-field="l.product_id.default_code"/>
                                                            </td>
                                                            <td style="border : 1px solid black">
                                                                <span t-field="l.lot_id.name"/>
                                                            </td>
                                                            <td style="border : 1px solid black">
                                                                <span t-field="l.qty_done"/>
                                                            </td>
                                                            <td style="border : 1px solid black">
                                                                <span t-field="l.lot_id.grade_id.name"/>
                                                            </td>
                                                            <td style="border : 1px solid black">
                                                                <span t-field="l.keterangan"/>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                </t>
                                                <tr style="padding-left : 10px ; padding-right : 10px" class="text-center">
                                                    <td colspan="3"/>
                                                    <td>
                                                        <span t-esc="'{0:,.2f}'.format(float(tot_qty))"/>
                                                    </td>
                                                </tr>
                                            </t>
                                            <tr>
                                                <td style="padding-right : 30px" class="text-right" colspan="3">
                                                    <span>JUMLAH</span>
                                                    <span/>
                                                    <span t-esc="'{0:,.2f}'.format(float(roll))"/>
                                                </td>
                                                <td class="text-right" width="40%">
                                                    <span t-esc="'{0:,.2f}'.format(float(grand_total))"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right : 30px" class="text-right" colspan="3">
                                                    <span>TARGET FINISH</span>
                                                    <span/>
                                                    <!-- <span t-esc="'{0:,.2f}'.format(float(o.production_id.product_qty))" /> -->
                                                </td>
                                                <td class="text-right" width="40%">
                                                    <span t-esc="'{0:,.2f}'.format(float(o.production_id.product_qty))"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right : 30px" class="text-right" colspan="3">
                                                    <span>BERAT GREY</span>
                                                </td>
                                                <td class="text-right" width="40%">
                                                    <span t-esc="'{0:,.2f}'.format(float(berat))"/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="padding-right : 30px" class="text-right" colspan="3">
                                                    <span>PANJANG ACTUAL (DF)</span>
                                                    <span/>
                                                    <!--<span t-esc="'{0:,.2f}'.format(float(roll))" />-->
                                                </td>
                                                <td style="border : 1px solid black" class="text-right" width="40%">
                                                    <!--<span t-esc="'{0:,.2f}'.format(float(grand_total))" />-->
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <!--END TABLE KIRI-->





                                <!--START TABLE KANAN-->
                                <td width="1%"/>
                                <td width="59%">
                                    <div class="text-right">OC-49 01 REV 01</div>
                                    <div class="text-left" style="margin-top : -20px ; margin-left : 50px">
                                        <b>DATA INSPECTING FINISH</b>
                                    </div>
                                    <table class="table-condensed" width="100%">
                                        <tr>
                                            <td width="30%">No. Job Order</td>
                                            <td>
                                                <span>:</span>
                                                <span t-field="o.mrp_request_id.sale_id.name"/>
                                            </td>
                                            <td style="border : 1px solid black ; padding-left : 10px" width="20%">Start
                                            </td>
                                        </tr>
                                        <tr>
                                            <td width="30%">Jumlah Permintaan</td>
                                            <td>
                                                <span>:</span>
                                                <span t-field="o.production_id.qty_yard_kp"/>
                                            </td>
                                            <td style="border : 1px solid black ; padding-left : 10px" width="20%">
                                                Finish</td>
                                        </tr>
                                        <tr>
                                            <td width="30%">Warna</td>
                                            <td>
                                                <span>:</span>
                                                <span t-field="o.production_id.product_id.color_id.name"/>
                                            </td>
                                            <td width="20%"/>
                                        </tr>
                                        <tr>
                                            <td width="30%">Id Batch</td>
                                            <td>
                                                <span>:</span>
                                                <span t-field="o.production_id.name"/>
                                            </td>
                                            <td style="border : 1px solid black ; padding-left : 10px" width="20%">ISP
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <table class="table-condensed" width="100%">
                                                    <tr>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%">Counter</td>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%">Manual</td>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%">Lebar Finish</td>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%">Skewing</td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="border : 1px solid black ; padding-left : 10px">Susut Finish</td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <table class="table-condensed" width="100%">
                                                    <tr>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%"/>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%"/>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%">Operator</td>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="25%">No MC</td>
                                                    </tr>
                                                </table>
                                                <table class="table-condensed" width="100%">
                                                    <tr>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="30%">Tanggal</td>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="30%">Std Potong</td>
                                                        <td style="border : 1px solid black ; padding-left : 10px" width="40%">Panjang Jadi</td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="border : 1px solid black ; padding-left : 10px"/>
                                        </tr>
                                    </table>
                                    <table class="table-condensed" width="100%">
                                        <tr class="text-center">
                                            <td style="border : 1px solid black" colspan="4">Grade</td>
                                            <td style="border : 1px solid black" colspan="6">Grade B</td>
                                            <td style="border : 1px solid black" rowspan="2">C</td>
                                        </tr>
                                        <tr class="text-center">
                                            <td style="border : 1px solid black" colspan="4">A</td>
                                            <td style="border : 1px solid black" colspan="2">WEAVING</td>
                                            <td style="border : 1px solid black" colspan="2">DF</td>
                                            <td style="border : 1px solid black" colspan="2">PERSIAPAN</td>
                                        </tr>
                                    </table>
                                    <table style="margin-top : 10px" class="table-condensed" width="100%">
                                        <t t-set="move" t-value="o.group_by_nozle_grade()"/>
                                        <t t-foreach="move" t-as="m">
                                            <tr class="text-center">
                                                <td style="border : 1px solid black">Pick</td>
                                                <td style="border : 1px solid black" colspan="2">Yard</td>
                                                <td style="border : 1px solid black">Point</td>
                                                <td style="border : 1px solid black">Yard</td>
                                                <td style="border : 1px solid black">Cacat</td>
                                                <td style="border : 1px solid black">Yard</td>
                                                <td style="border : 1px solid black">Cacat</td>
                                                <td style="border : 1px solid black">Yard</td>
                                                <td style="border : 1px solid black">Cacat</td>
                                                <td style="border : 1px solid black">Yard</td>
                                            </tr>
                                            <t t-foreach="o.move_line_ids_without_package" t-as="l">
                                                <t t-if="m == o.get_selection_label('stock.move.line', 'nozle', l.nozle)">
                                                    <tr t-foreach="range(2)" t-as="x">
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                        <td style="border : 1px solid black" height="20px"/>
                                                    </tr>
                                                </t>
                                            </t>
                                        </t>
                                    </table>
                                </td>
                                <!--END TABLE KANAN-->
                            </tr>
                        </table>

                    </div>
                </t>
            </t>


            <!-- PAGE 2 -->


            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <div class="article">
                        <br/>
                        <br/>
                        <br/>
                        <table class="table-condensed" width="100%">
                            <tr class="text-center">
                                <td style="border : 1px solid black" rowspan="2" colspan="4">UKURAN STANDAR
                                </td>
                                <td style="border : 1px solid black" rowspan="2" colspan="4">UKURAN NON
                                                STANDAR</td>
                                <td style="border : 1px solid black" colspan="4">B</td>
                                <td style="border : 1px solid black" rowspan="2">C</td>
                            </tr>
                            <tr class="text-center">
                                <td style="border : 1px solid black">YD</td>
                                <td style="border : 1px solid black">CI</td>
                                <td style="border : 1px solid black">YD</td>
                                <td style="border : 1px solid black">CI</td>
                            </tr>
                            <tr class="text-center">
                                <td style="border : 1px solid black" colspan="3">X</td>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black">+</td>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black">+</td>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black"/>
                                <td style="border : 1px solid black"/>
                            </tr>
                            <tr t-foreach="range(7)" t-as="x" class="text-center">
                                <td style="border : 1px solid black" width="20px">+</td>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px">+</td>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px">+</td>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px">+</td>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px"/>
                                <td style="border : 1px solid black" width="20px"/>
                            </tr>
                        </table>
                        <table style="margin-top : 10px" class="table-condensed" width="100%">
                            <tr>
                                <td style="border : 1px solid black" rowspan="2" colspan="2">
                                    <span>Jumlah Jahitan Bermarkpen :</span>
                                    <br/>
                                    <br/>
                                    <span>Jumlah Jahitan tidak Bermarkpen :</span>
                                </td>
                                <td style="border : 1px solid black" rowspan="2">
                                    <span>Sample :</span>
                                </td>
                                <td style="border : 1px solid black" colspan="3" class="text-center">GRADE C
                                </td>
                            </tr>
                            <tr>
                                <td style="border : 1px solid black">Ukuran</td>
                                <td style="border : 1px solid black">Kg</td>
                                <td style="border : 1px solid black">Yard / Meter</td>
                            </tr>
                            <tr>
                                <td style="border : 1px solid black">Cacat Weaving</td>
                                <td style="border : 1px solid black">Cacat DF</td>
                                <td style="border : 1px solid black">Cacat PSP</td>
                                <td rowspan="2">
                                    <table class="table-condensed" width="100%">
                                        <tr>
                                            <td style="border : 1px solid black">
                                                <br/>
                                                <br/>
                                                <br/>
                                                <br/>
                                                <br/>
                                            </td>
                                        </tr>
                                        <td style="border : 1px solid black">
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                        </td>
                                    </table>
                                </td>
                                <td rowspan="2">
                                    <table class="table-condensed" width="100%">
                                        <tr>
                                            <td style="border : 1px solid black">
                                                <br/>
                                                <br/>
                                                <br/>
                                                <br/>
                                                <br/>
                                            </td>
                                        </tr>
                                        <td style="border : 1px solid black">
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                        </td>
                                    </table>
                                </td>
                                <td rowspan="2">
                                    <table class="table-condensed" width="100%">
                                        <tr>
                                            <td style="border : 1px solid black">
                                                <br/>
                                                <br/>
                                                <br/>
                                                <br/>
                                                <br/>
                                            </td>
                                        </tr>
                                        <td style="border : 1px solid black">
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                            <br/>
                                        </td>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td style="border : 1px solid black">
                                    <span>1. Problem Lusi</span>
                                    <br/>
                                    <br/>
                                    <span>2. Problem Pakan</span>
                                    <br/>
                                    <br/>
                                    <span>3. Snarling</span>
                                    <br/>
                                    <br/>
                                    <span>4. Oli Wraving</span>
                                    <br/>
                                    <br/>
                                    <span>5. Lain2 Weav</span>
                                    <br/>
                                    <br/>
                                </td>
                                <td style="border : 1px solid black">
                                    <span>6. Obat</span>
                                    <br/>
                                    <br/>
                                    <span>7. Slepage</span>
                                    <br/>
                                    <br/>
                                    <span>8. Krismark</span>
                                    <br/>
                                    <br/>
                                    <span>9. Oli DF</span>
                                    <br/>
                                    <br/>
                                    <span>10. Lain2 DF</span>
                                    <br/>
                                    <br/>
                                </td>
                                <td style="border : 1px solid black">
                                    <span>11. Bandline</span>
                                    <br/>
                                    <br/>
                                    <span>12. Warpline</span>
                                    <br/>
                                    <br/>
                                    <span>13. Lusi Abnormal</span>
                                    <br/>
                                    <br/>
                                    <span>14. Lain2 PSP</span>
                                    <br/>
                                    <br/>
                                </td>
                            </tr>
                        </table>
                        <table style="margin-top : 10px" class="table-condensed" width="100%">
                            <tr class="text-center">
                                <td style="border : 1px solid black" colspan="6">TOTAL</td>
                            </tr>
                            <tr class="text-center">
                                <td style="border : 1px solid black" colspan="2">Grade A</td>
                                <td style="border : 1px solid black" colspan="2">Grade B</td>
                                <td style="border : 1px solid black" colspan="2">Grade C</td>
                            </tr>
                            <tr class="text-center">
                                <td style="border : 1px solid black">Yard</td>
                                <td style="border : 1px solid black">Pcs</td>
                                <td style="border : 1px solid black">Yard</td>
                                <td style="border : 1px solid black">Pcs</td>
                                <td style="border : 1px solid black">Yard</td>
                                <td style="border : 1px solid black">Pcs</td>
                            </tr>
                            <tr class="text-center">
                                <td style="border : 1px solid black" height="20px"/>
                                <td style="border : 1px solid black" height="20px"/>
                                <td style="border : 1px solid black" height="20px"/>
                                <td style="border : 1px solid black" height="20px"/>
                                <td style="border : 1px solid black" height="20px"/>
                                <td style="border : 1px solid black" height="20px"/>
                            </tr>
                        </table>
                        <table class="table-condensed" width="100%">
                            <tr class="text-center">
                                <td>
                                    <span>Penerima</span>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <span>(                           )</span>
                                </td>
                                <td>
                                    <span>Pembuat Data</span>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <span>(                           )</span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </template>










        <record model="report.paperformat" id="paperformat_pengeluaran_greige_a5">
            <field name="name">Pengeluaran Greige A5</field>
            <field name="default" eval="True" />
            <field name="format">custom</field>
            <field name="page_width">210</field>
            <field name="page_height">140</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">2</field>
            <field name="margin_bottom">2</field>
            <field name="margin_right">2</field>
            <field name="margin_left">2</field>
            <field name="header_line" eval="False" />
            <field name="header_spacing">35</field>
            <field name="dpi">90</field>
        </record>

        <report id="action_pengeluaran_greige_a5" model="stock.picking" string="Print Pengeluaran Greige A5" report_type="qweb-pdf" name="my_report.pengeluaran_greige_a5" file="my_report.pengeluaran_greige_a5" />

        <record id="action_pengeluaran_greige_a5" model="ir.actions.report">
            <field name="paperformat_id" eval="paperformat_pengeluaran_greige_a5" />
        </record>

        <template id="pengeluaran_greige_a5">
            <t t-call="web.basic_layout">
                <t t-foreach="docs" t-as="o">
                    <div class="page" style="font-size : 20px">
                        <div class="row">
                            <div class="col-5"></div>
                            <div class="col-7">
                                <br />
                                <br />
                                <span style="margin-left : 300px; font-size:40px;">
                                    <b>FKT</b>
                                </span>
                                <br />
                                <br />
                                <span>Kepada Yth :</span>
                                <br />
                                <span t-field="o.partner_id" />
                                <br />
                                <br />
                                <span t-field="o.partner_id.street" />
                                <br />
                                <br />
                                <span>UP : BAG. AKUNTING</span>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </template>
        

    </data>
</odoo>