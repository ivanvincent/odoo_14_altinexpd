<odoo>


    <record id="report_stock_opname_action" model="ir.actions.report">
        <field name="name">Reporting Stock Opname (PDF)</field>
        <field name="model">reporting.stock</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">reporting.report_stock_opname_session</field>
        <field name="report_file">reporting.print_stock_opname</field>
        <field name="print_report_name">'Reporting - %s' % (object.name)</field>
        <field name="binding_model_id" ref="model_reporting_stock" />
        <field name="binding_view_types">form</field>
    </record>


    <!-- Report Template Header - Session -->

    <template id="header_session">
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id"></t>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"></t>
        </t>
        <!-- <div class="header"> -->
            <div class="row">
                <div class="col-6">
                    <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % to_text(company.logo)"
                        style="max-height: 100px;" />
                </div>
                <div class="col-6 text-right"
                    style="font:15px lucida-console,sans-serif !important;background-color:#243742;padding:10px">
                    <span t-field="company.partner_id" style="font-size: 20px;color:white;font-weight: bold;" />
                    <br />
                    <span t-field="company.partner_id.street" style="color:white;font-weight: bold;" />
                    <br />
                    <span t-field="company.partner_id.city" style="color:white;font-weight: bold;" />
                    <br />
                    <span t-field="company.partner_id.country_id" style="color:white;font-weight: bold;" />
                    <br />
                    <span t-field="company.partner_id.vat" style="color:white;" />
                    <br />
                </div>
            </div>
        <!-- </div> -->
    </template>


    <!-- Report Template Body - Session -->

    <template id="body_session">
        <!-- <div class="page"> -->
            <h1 class="d-flex justify-content-center">
                <span>Stock Opname</span>
                <span style="padding:5px" t-esc="o.location_id.location_id.name" />
            </h1>
            <div class="d-flex justify-content-center">
                <table class="table table-bordered" style="width:50%">
                    <tbody>
                        <tr>
                            <td style="width:25%; background-color:#243742; padding:5px;color:white;font-weight: bold;">
                                <span>Start Date</span>
                            </td>
                            <td style="width:75%;padding:5px;">
                                <t t-if="o.start_date">
                                    <t t-esc="o.start_date.strftime('%d/%m/%Y')" />
                                </t>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table table-bordered" style="width:50%">
                    <tbody>
                        <tr>
                            <td style="width:25%; background-color:#243742; padding:5px;color:white;font-weight: bold;">
                                <span>End Date</span>
                            </td>
                            <td style="width:75%;padding:5px;">
                                <t t-if="o.end_date">
                                    <t t-esc="o.end_date.strftime('%d/%m/%Y')" />
                                </t>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>


            <t t-set="product_category" t-value="[]" />
            <t t-foreach="o.line_ids" t-as="l">
                <t t-set="product_category" t-value="product_category + [l.categ_id]" />
            </t>
            <t t-foreach="set(product_category)" t-as="category">
                <!-- <div style="padding-top : 30px"> -->
                    <strong t-esc="category.name" />
                <!-- </div> -->
                <table class="divTable ReportingStock table-condensed" width="100%">
                    <thead class="divTableHeading">
                        <tr class="divTableRow">
                            <th class="divTableHead">Kode Barang</th>
                            <th class="divTableHead">Product</th>
                            <th class="divTableHead">Uom</th>
                            <th class="divTableHead" groups="account.group_account_readonly">Balance</th>
                            <th class="divTableHead">Opname</th>
                            <th class="divTableHead">Selisih</th>
                        </tr>
                    </thead>
                    <t t-set="no" t-value="0" />
                    <t t-foreach="o.line_ids.sorted(key=lambda r: r.product_id.name, reverse=False)" t-as="l">
                        <t t-set="no" t-value="no + 1" />
                        <t t-if="category.id == l.product_id.categ_id.id and l.qty_balance > 0">
                            <tbody class="divTableBody">
                                <tr class="divTableRow">
                                    <td class="divTableCell">
                                        <span t-field="l.product_code" />
                                    </td>
                                    <td class="divTableCell">
                                        <span t-field="l.product_id.name" />
                                    </td>
                                    <td class="divTableCell">
                                        <span t-field="l.uom_id.name" />
                                    </td>
                                    <td class="divTableCell text-right" groups="account.group_account_readonly">
                                        <span t-field="l.qty_balance" />
                                    </td>
                                    <td class="divTableCell"></td>
                                    <td class="divTableCell"></td>
                                </tr>
                            </tbody>
                        </t>
                    </t>
                    <tfoot class="divTableFooter tableFootStyle">
                        <tr class="divTableRow">
                            <td class="divTableFoot">
                                <span>Sub Total</span>
                                <span t-esc="category.name" />
                            </td>
                            <td class="divTableFoot"></td>
                            <td class="divTableFoot"></td>
                            <td class="divTableFoot" groups="account.group_account_readonly"></td>
                            <td class="divTableFoot"></td>
                            <td class="divTableFoot"></td>
                        </tr>
                    </tfoot>
                </table>
                <!-- <span class="font-weight-bold">Print Date : </span>
                <span t-esc="datetime.datetime.now().strftime('%Y-%m-%d')"></span>
                <div class="ttd" style="margin-top: 2rem;">
                    <div class="row text-center">
                        <div class="col-4">
                            <span>Kepala Bagian</span><br/><br/><br/>
                            <span>_____</span><br/>
                            <span/><br/>
                        </div>
                        <div class="col-4">
                            <span>Petugas Opname</span><br/><br/><br/>
                            <span>_____</span>
                            <span></span><br/>
                        </div>
                        <div class="col-4">
                            <span>Admin</span><br/><br/><br/><br/>
                            <span t-esc="o.user_id.name"/>
                            <span></span><br/>
                        </div>
                    </div>
                </div> -->
            </t>
        <!-- </div> -->
    </template>

    <!-- Report Template - Session -->

    <template id="report_stock_opname_session">
        <t t-call="web.html_container">
            <!-- <div t-if="report_type == 'html'">
                <div>
                    <t t-call="reporting.header_session" />
                </div>
                <div style="margin-top:150px">
                    <t t-call="reporting.body_session" />
                </div>
            </div> -->
            <!-- <t t-call="reporting.header_session" /> -->
            <t t-call="web.basic_layout">
                <div class="page">
                    <t t-if="o and 'company_id' in o">
                        <t t-set="company" t-value="o.company_id"></t>
                    </t>
                    <t t-if="not o or not 'company_id' in o">
                        <t t-set="company" t-value="res_company"></t>
                    </t>
                    <!-- <div class="header"> -->
                        <div class="row mt32 mb32">
                            <div class="col-6">
                                <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % to_text(company.logo)"
                                    style="max-height: 100px;" />
                            </div>
                            <div class="col-6 text-right"
                                style="font:15px lucida-console,sans-serif !important;background-color:#243742;padding:10px">
                                <span t-field="company.partner_id" style="font-size: 20px;color:white;font-weight: bold;" />
                                <br />
                                <span t-field="company.partner_id.street" style="color:white;font-weight: bold;" />
                                <br />
                                <span t-field="company.partner_id.city" style="color:white;font-weight: bold;" />
                                <br />
                                <span t-field="company.partner_id.country_id" style="color:white;font-weight: bold;" />
                                <br />
                                <span t-field="company.partner_id.vat" style="color:white;" />
                                <br />
                            </div>
                        </div>
                    <!-- </div> -->
                    <t t-foreach="docs" t-as="o">
                        <t t-call="reporting.body_session" />
                        <span class="font-weight-bold">Print Date : </span>
                        <span t-esc="datetime.datetime.now().strftime('%Y-%m-%d')"></span>
                        <div class="ttd" style="margin-top: 2rem;">
                            <div class="row text-center">
                                <div class="col-4">
                                    <span>Kepala Bagian</span><br/><br/><br/>
                                    <span>_____</span><br/>
                                    <span/><br/>
                                </div>
                                <div class="col-4">
                                    <span>Petugas Opname</span><br/><br/><br/>
                                    <span>_____</span>
                                    <span></span><br/>
                                </div>
                                <div class="col-4">
                                    <span>Admin</span><br/><br/><br/><br/>
                                    <span t-esc="o.user_id.name"/>
                                    <span></span><br/>
                                </div>
                            </div>
                        </div>
                    </t>
                </div>
            </t>
        </t>
    </template>


</odoo>