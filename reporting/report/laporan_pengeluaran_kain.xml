<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record model="report.paperformat" id="paperformat_laporan_pengeluaran_kain">
            <field name="name">Laporan Pengeluaran Kain Greige</field>
            <field name="default" eval="True" />
            <field name="format">custom</field>
            <field name="page_width">210</field>
            <field name="page_height">297</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">2</field>
            <field name="margin_bottom">2</field>
            <field name="margin_right">2</field>
            <field name="margin_left">2</field>
            <field name="header_line" eval="False" />
            <field name="header_spacing">35</field>
            <field name="dpi">90</field>
        </record>

        <report id="action_laporan_pengeluaran_kain" model="reporting.stock.lot"
            string="Laporan Pengeluaran Kain Greige" report_type="qweb-pdf" name="reporting.laporan_pengeluaran_kain"
            file="reporting.laporan_pengeluaran_kain" />

        <record id="action_laporan_pengeluaran_kain" model="ir.actions.report">
            <field name="paperformat_id" eval="paperformat_laporan_pengeluaran_kain" />
        </record>

        <template id="laporan_pengeluaran_kain">
            <t t-call="web.basic_layout">
                <style>
                    @font-face {
                        font-family: 'Courier New';
                        font-style: normal;
                        font-weight: 400;
                        src: local('Courier New'), local('CourierNewPSMT'), url(http://themes.googleusercontent.com/licensed/font?kit=p0pJArTTK5Heq6xbYtNwnp0EAVxt0G0biEntp43Qt6E) format('truetype');
                    }

                    .Courier {
                        font-family: Courier New;
                    }

                    .table-data th,
                    .table-data td {
                        border: 1px solid black;
                        font-family: Courier New;
                    }
                </style>
                <t t-foreach="docs" t-as="o">

                    <div class="page Courier" style="font-size : 18px">
                        <div class="text-right">GG-02.5 REV-00</div>
                        <div class="text-center" style="margin-top : -20px">
                            <b>LAPORAN PENGELUARAN KAIN GREY</b>
                        </div>
                        <div class="text-center">
                            <span>Periode</span>
                            <span t-field="o.start_date" />
                            <span>s/d</span>
                            <span t-field="o.end_date" />
                        </div>

                        <table class="table-condensed table-data" width="100%">
                            <thead class="text-center">
                                <tr>
                                    <th rowspan="2">No</th>
                                    <th rowspan="2">KODE KAIN</th>
                                    <th rowspan="2">NAMA KAIN</th>
                                    <th colspan="2">GULUNG</th>
                                    <th colspan="2">QUANTITY</th>
                                </tr>
                                <tr>
                                    <th>ABCD</th>
                                    <th>BS</th>
                                    <th>ABCD</th>
                                    <th>BS</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="no" t-value="0" />
                                <t t-set="tot_roll" t-value="0" />
                                <t t-set="tot_qty" t-value="0" />
                                <t t-set="tot_x_roll" t-value="0" />
                                <t t-set="tot_x_qty" t-value="0" />
                                <t t-set="move" t-value="o.group_by_print_laporan_penerimaan_kain_grey()" />
                                <t t-foreach="move" t-as="m">
                                    <t t-set="no" t-value="no + 1" />
                                    <t t-set="tot_roll" t-value="tot_roll + m['roll']" />
                                    <t t-set="tot_qty" t-value="tot_qty + m['qty']" />


                                    <t t-set="x_roll" t-value="m['x_roll'] if m['x_roll'] else 0" />
                                    <t t-set="x_qty" t-value="m['x_qty'] if m['x_qty'] else 0" />
                                    <t t-set="tot_x_roll" t-value="tot_x_roll + x_roll" />
                                    <t t-set="tot_x_qty" t-value="tot_x_qty + x_qty" />
                                    <tr>
                                        <td>
                                            <span t-esc="no" />
                                        </td>
                                        <td>
                                            <span t-esc="m['code']" />
                                        </td>
                                        <td>
                                            <span t-esc="m['product']" />
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="m['roll']" />
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="m['qty']" />
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="m['x_roll']" />
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="m['x_qty']" />
                                        </td>
                                    </tr>
                                </t>
                                <tr>
                                    <td colspan="3" class="text-center">TOTAL</td>
                                    <td class="text-right">
                                        <span t-esc="tot_roll" />
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="tot_qty" />
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="tot_x_roll" />
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="tot_x_qty" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table-condensed" width="100%">
                            <tr class="text-center">
                                <td>
                                    <span>Diketahui / Disetujui</span>
                                </td>
                                <td>
                                    <span>Pembuat Data</span>
                                </td>
                            </tr>
                        </table>

                    </div>


                </t>
            </t>
        </template>
    </data>
</odoo>